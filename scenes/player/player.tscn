[gd_scene load_steps=70 format=3 uid="uid://dhp71vl6av8ov"]

[ext_resource type="Script" path="res://scripts/player/player.gd" id="1_wfvhb"]
[ext_resource type="Texture2D" uid="uid://dtqk2r7dk4nfv" path="res://sprites/Peppino/hurtwalk_00.png" id="2_1i5yc"]
[ext_resource type="Texture2D" uid="uid://bmn4ffwptjxco" path="res://sprites/Peppino/hurtidle_00.png" id="2_3c5fl"]
[ext_resource type="Texture2D" uid="uid://k36fsrgw3bsa" path="res://sprites/Peppino/[Unused]/machpunch1_00.png" id="2_yopqp"]
[ext_resource type="Texture2D" uid="uid://bdvxdkfcdlrhy" path="res://sprites/Peppino/hurtwalk_01.png" id="3_750nu"]
[ext_resource type="Texture2D" uid="uid://c4ycmrpw8s0rx" path="res://sprites/Peppino/hurtidle_01.png" id="3_is1rs"]
[ext_resource type="PackedScene" uid="uid://d1btdy1brmsea" path="res://scenes/player/player_debug.tscn" id="4_76pis"]
[ext_resource type="Texture2D" uid="uid://b365xc0w03gvp" path="res://sprites/Peppino/hurtidle_02.png" id="4_l457h"]
[ext_resource type="Texture2D" uid="uid://tihpbbu73xa1" path="res://sprites/Peppino/hurtwalk_02.png" id="4_tv315"]
[ext_resource type="Texture2D" uid="uid://bb3bq5irdukkp" path="res://sprites/Peppino/hurtidle_03.png" id="5_s085y"]
[ext_resource type="Texture2D" uid="uid://b6i5j4wl6g8yj" path="res://sprites/Peppino/hurtwalk_03.png" id="5_y3myp"]
[ext_resource type="Texture2D" uid="uid://bggskpyww205j" path="res://sprites/Peppino/hurtwalk_04.png" id="6_m8rwl"]
[ext_resource type="Texture2D" uid="uid://bt266gpcsahya" path="res://sprites/Peppino/hurtidle_04.png" id="6_rstxw"]
[ext_resource type="Texture2D" uid="uid://c8bhwpklogkj4" path="res://sprites/Peppino/hurtidle_05.png" id="7_8w4bg"]
[ext_resource type="Texture2D" uid="uid://bs1wtmwyt3gjs" path="res://sprites/Peppino/hurtwalk_05.png" id="7_xkwt4"]
[ext_resource type="Texture2D" uid="uid://dmf8qygitt0gd" path="res://sprites/Peppino/hurtidle_06.png" id="8_vcmrn"]
[ext_resource type="Texture2D" uid="uid://dfuepexmvd75c" path="res://sprites/Peppino/hurtwalk_06.png" id="8_yohkk"]
[ext_resource type="Texture2D" uid="uid://d4cgg4scyvhf1" path="res://sprites/Peppino/hurtidle_07.png" id="9_fhiu8"]
[ext_resource type="Texture2D" uid="uid://bsbfjoijixycj" path="res://sprites/Peppino/hurtwalk_07.png" id="9_yyptb"]
[ext_resource type="Texture2D" uid="uid://dvgrhwmteda17" path="res://sprites/Peppino/hurtwalk_08.png" id="10_63ccy"]
[ext_resource type="Texture2D" uid="uid://dul3w557ke5l1" path="res://sprites/Peppino/hurtidle_08.png" id="10_xelsj"]
[ext_resource type="Texture2D" uid="uid://bfpd1dbxffe46" path="res://sprites/Peppino/hurtidle_09.png" id="11_nifgk"]
[ext_resource type="Texture2D" uid="uid://ywksf2r6ed2v" path="res://sprites/Peppino/hurtwalk_09.png" id="11_urwhe"]
[ext_resource type="Texture2D" uid="uid://be0geora5iv1f" path="res://sprites/Peppino/hurtidle_10.png" id="12_88dxg"]
[ext_resource type="Texture2D" uid="uid://jlol23j4umjd" path="res://sprites/Peppino/hurtwalk_10.png" id="12_lr2jm"]
[ext_resource type="Texture2D" uid="uid://bon7hbiyunjqh" path="res://sprites/Peppino/hurtidle_11.png" id="13_8gtaq"]
[ext_resource type="Texture2D" uid="uid://bvd75i4wqf3k2" path="res://sprites/Peppino/hurtwalk_11.png" id="13_n7g6e"]
[ext_resource type="Texture2D" uid="uid://ci4p7eox8ga1u" path="res://sprites/Peppino/hurtidle_12_14.png" id="14_cvh8e"]
[ext_resource type="Texture2D" uid="uid://br7uym0ibkv50" path="res://sprites/Peppino/hurtidle_13_15.png" id="15_jab1k"]
[ext_resource type="Texture2D" uid="uid://57sads6lbh5" path="res://sprites/Peppino/hurtidle_16.png" id="16_45kq1"]
[ext_resource type="Texture2D" uid="uid://ddotgx5gx2he7" path="res://sprites/Peppino/hurtidle_17.png" id="17_iqt51"]
[ext_resource type="Texture2D" uid="uid://csow8gnofc3rg" path="res://sprites/Peppino/hurtidle_18.png" id="18_thvpd"]
[ext_resource type="Texture2D" uid="uid://l645lfusojij" path="res://sprites/Peppino/hurtidle_19.png" id="19_6hvo4"]
[ext_resource type="Texture2D" uid="uid://msahv5hcwymo" path="res://sprites/Peppino/[Unused]/mach3_00.png" id="20_t053x"]
[ext_resource type="Texture2D" uid="uid://bayt5elabufrn" path="res://sprites/Peppino/[Unused]/mach3_01.png" id="21_i4ij0"]
[ext_resource type="Texture2D" uid="uid://ctdqc3dt776yi" path="res://sprites/Peppino/[Unused]/mach3_02.png" id="22_4s1nr"]
[ext_resource type="Texture2D" uid="uid://b2yryib2jnwbd" path="res://sprites/Peppino/[Unused]/mach3_03.png" id="23_5e4i4"]
[ext_resource type="Texture2D" uid="uid://d3ksvam0xnumh" path="res://sprites/Peppino/[Unused]/mach3_04.png" id="24_gl2qc"]
[ext_resource type="Texture2D" uid="uid://mkqw1km7myce" path="res://sprites/Peppino/[Unused]/mach3_05.png" id="25_oxtif"]
[ext_resource type="Texture2D" uid="uid://bs3y1wj43ig81" path="res://sprites/Peppino/machslideend_05.png" id="38_6lafu"]
[ext_resource type="Texture2D" uid="uid://ci0qpxug5x04m" path="res://sprites/Peppino/[Unused]/machpunch1_01.png" id="50_smsio"]
[ext_resource type="Texture2D" uid="uid://dnokjxqq2rfrm" path="res://sprites/Peppino/[Unused]/machpunch1_02.png" id="51_hmbj6"]
[ext_resource type="Texture2D" uid="uid://bfe1bnh4vxaow" path="res://sprites/Peppino/machslidestart_00.png" id="51_n4iip"]
[ext_resource type="Texture2D" uid="uid://ci01dfxaxl4em" path="res://sprites/Peppino/machslidestart_01.png" id="52_h7cy4"]
[ext_resource type="Texture2D" uid="uid://cgf55hj8kusaa" path="res://sprites/Peppino/[Unused]/machpunch1_03.png" id="52_x141e"]
[ext_resource type="Texture2D" uid="uid://dl7k0d8aa5ell" path="res://sprites/Peppino/[Unused]/machpunch1_04.png" id="53_jpys2"]
[ext_resource type="Texture2D" uid="uid://bbu861qoayyry" path="res://sprites/Peppino/machslidestart_02.png" id="53_qjr2q"]
[ext_resource type="Texture2D" uid="uid://cg58au2gxxmd8" path="res://sprites/Peppino/machslidestart_03.png" id="54_1oywq"]
[ext_resource type="Texture2D" uid="uid://by4wks6ffmjvp" path="res://sprites/Peppino/[Unused]/machpunch2_00.png" id="54_aet84"]
[ext_resource type="Texture2D" uid="uid://bf4xb4oh1ufps" path="res://sprites/Peppino/machslidestart_04.png" id="55_a3t2u"]
[ext_resource type="Texture2D" uid="uid://cu7s3r47gc8y" path="res://sprites/Peppino/[Unused]/machpunch2_01.png" id="55_u182p"]
[ext_resource type="Texture2D" uid="uid://duijwjij4xhcx" path="res://sprites/Peppino/machslidestart_05.png" id="56_j0fji"]
[ext_resource type="Texture2D" uid="uid://btosqpij5disr" path="res://sprites/Peppino/[Unused]/machpunch2_02.png" id="56_kx77h"]
[ext_resource type="Texture2D" uid="uid://d36whevqw4rtv" path="res://sprites/Peppino/machslidestart_06.png" id="57_j8uu6"]
[ext_resource type="Texture2D" uid="uid://bph14edv6v1px" path="res://sprites/Peppino/[Unused]/machpunch2_03.png" id="57_mpf2h"]
[ext_resource type="Texture2D" uid="uid://mwnt65bi34o3" path="res://sprites/Peppino/[Unused]/machpunch2_04.png" id="58_0hgwm"]
[ext_resource type="Texture2D" uid="uid://dj82ylhkyjthg" path="res://sprites/Peppino/machslide_00.png" id="58_cqqdx"]
[ext_resource type="Texture2D" uid="uid://dxrjeibj7occj" path="res://sprites/Peppino/machslide_01.png" id="59_gxjik"]
[ext_resource type="Shape2D" uid="uid://bygddctap0ysj" path="res://materials/shapes/player_normal_collision_shape.tres" id="59_syb2e"]
[ext_resource type="Texture2D" uid="uid://4wcb2da7kx8w" path="res://sprites/Peppino/machslide_02.png" id="60_202wg"]
[ext_resource type="PackedScene" uid="uid://w07m35qgysc0" path="res://scenes/components/entity_component_system.tscn" id="61_lv68y"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_jkgb2"]
size = Vector2(32, 75)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_g63mw"]
size = Vector2(6, 1)

[sub_resource type="Animation" id="Animation_oqob7"]
resource_name = "idle"
length = 1.50001
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75, 0.833333, 0.916667, 1, 1.08333, 1.16667, 1.25, 1.33333, 1.41667),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [ExtResource("2_3c5fl"), ExtResource("3_is1rs"), ExtResource("4_l457h"), ExtResource("5_s085y"), ExtResource("6_rstxw"), ExtResource("7_8w4bg"), ExtResource("8_vcmrn"), ExtResource("9_fhiu8"), ExtResource("10_xelsj"), ExtResource("11_nifgk"), ExtResource("12_88dxg"), ExtResource("13_8gtaq"), ExtResource("14_cvh8e"), ExtResource("15_jab1k"), ExtResource("16_45kq1"), ExtResource("17_iqt51"), ExtResource("18_thvpd"), ExtResource("19_6hvo4")]
}

[sub_resource type="Animation" id="Animation_ahvci"]
resource_name = "run"
length = 0.500008
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0833333, 0.166667, 0.25, 0.333333, 0.416667),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 1,
"values": [ExtResource("20_t053x"), ExtResource("21_i4ij0"), ExtResource("22_4s1nr"), ExtResource("23_5e4i4"), ExtResource("24_gl2qc"), ExtResource("25_oxtif")]
}

[sub_resource type="Animation" id="Animation_joimf"]
resource_name = "run_to_idle"
length = 0.916675
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75, 0.833333),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [ExtResource("38_6lafu"), ExtResource("51_n4iip"), ExtResource("52_h7cy4"), ExtResource("53_qjr2q"), ExtResource("54_1oywq"), ExtResource("55_a3t2u"), ExtResource("56_j0fji"), ExtResource("57_j8uu6"), ExtResource("58_cqqdx"), ExtResource("59_gxjik"), ExtResource("60_202wg")]
}

[sub_resource type="Animation" id="Animation_xdvwl"]
resource_name = "walk"
length = 1.00001
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75, 0.833333, 0.916667),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [ExtResource("2_1i5yc"), ExtResource("3_750nu"), ExtResource("4_tv315"), ExtResource("5_y3myp"), ExtResource("6_m8rwl"), ExtResource("7_xkwt4"), ExtResource("8_yohkk"), ExtResource("9_yyptb"), ExtResource("10_63ccy"), ExtResource("11_urwhe"), ExtResource("12_lr2jm"), ExtResource("13_n7g6e")]
}

[sub_resource type="Animation" id="Animation_0jd3j"]
resource_name = "walk_to_run"
length = 0.833342
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [ExtResource("2_yopqp"), ExtResource("50_smsio"), ExtResource("51_hmbj6"), ExtResource("52_x141e"), ExtResource("53_jpys2"), ExtResource("54_aet84"), ExtResource("55_u182p"), ExtResource("56_kx77h"), ExtResource("57_mpf2h"), ExtResource("58_0hgwm")]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_jpkbe"]
_data = {
"idle": SubResource("Animation_oqob7"),
"run": SubResource("Animation_ahvci"),
"run_to_idle": SubResource("Animation_joimf"),
"walk": SubResource("Animation_xdvwl"),
"walk_to_run": SubResource("Animation_0jd3j")
}

[node name="Player" type="CharacterBody2D"]
collision_layer = 2
collision_mask = 49
wall_min_slide_angle = 0.523599
floor_block_on_wall = false
floor_snap_length = 2.0
script = ExtResource("1_wfvhb")

[node name="Label" type="Label" parent="."]
visible = false
offset_left = -336.0
offset_top = -536.0
offset_right = -296.0
offset_bottom = -513.0
scale = Vector2(17.9859, 16.338)
text = "TEST"

[node name="Sprite" type="Sprite2D" parent="."]
texture_filter = 1
scale = Vector2(2.35, 2.35)
texture = ExtResource("2_3c5fl")
offset = Vector2(0, -28.6131)

[node name="Rotatable" type="Node2D" parent="."]

[node name="SlideCollisionShapePosition" type="Node2D" parent="Rotatable"]
position = Vector2(0, 28)

[node name="Polygon2D" type="Polygon2D" parent="Rotatable/SlideCollisionShapePosition"]
visible = false
self_modulate = Color(1, 1, 1, 0.478431)
polygon = PackedVector2Array(0, -28, -8, -4, 0, 28, 8, -4)

[node name="Casts" type="Node2D" parent="Rotatable"]

[node name="DownCast" type="RayCast2D" parent="Rotatable/Casts"]
target_position = Vector2(0, 41)

[node name="UpCast0" type="RayCast2D" parent="Rotatable/Casts"]
position = Vector2(-32, 0)
target_position = Vector2(-1.45519e-11, -57)

[node name="UpCast1" type="RayCast2D" parent="Rotatable/Casts"]
position = Vector2(32, 0)
target_position = Vector2(-1.45519e-11, -57)

[node name="RightCast" type="RayCast2D" parent="Rotatable/Casts"]
position = Vector2(0, -24)
target_position = Vector2(45, 0)

[node name="LeftCast" type="RayCast2D" parent="Rotatable/Casts"]
position = Vector2(0, -24)
target_position = Vector2(-45, 0)

[node name="EntityComponentSystem" parent="Rotatable" node_paths=PackedStringArray("components_owner") instance=ExtResource("61_lv68y")]
entity_type = 2
components_owner = NodePath("../..")
contact_damage = false

[node name="CollisionShape" parent="Rotatable/EntityComponentSystem" index="0"]
position = Vector2(0, 3)
shape = SubResource("RectangleShape2D_jkgb2")
debug_color = Color(0.858824, 0, 0.878431, 0.419608)

[node name="GrindAreaPos0" type="Node2D" parent="Rotatable"]
position = Vector2(0, 40)

[node name="GrindAreaPos1" type="Node2D" parent="Rotatable"]
position = Vector2(0, 20)

[node name="GrindArea" type="Area2D" parent="Rotatable"]

[node name="Shape" type="CollisionShape2D" parent="Rotatable/GrindArea"]
position = Vector2(0, 40)
shape = SubResource("RectangleShape2D_g63mw")
debug_color = Color(0.796078, 0.423529, 0, 1)

[node name="Anim" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_jpkbe")
}

[node name="Shape" type="CollisionShape2D" parent="."]
shape = ExtResource("59_syb2e")

[node name="PlayerDebug" parent="." instance=ExtResource("4_76pis")]
visible = true
offset_top = -32.0
offset_bottom = -32.0
metadata/_edit_lock_ = true
metadata/_edit_group_ = true

[node name="Timers" type="Node" parent="."]

[node name="RunBufferTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.05
one_shot = true

[node name="SlideTimer" type="Timer" parent="Timers"]
editor_description = "used"
process_callback = 0
wait_time = 0.5
one_shot = true

[node name="FirstJumpStateTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.15
one_shot = true

[node name="SecondJumpStateTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.15
one_shot = true

[node name="JumpInputBuffer" type="Timer" parent="Timers"]
wait_time = 0.1
one_shot = true

[node name="BumpTimer" type="Timer" parent="Timers"]
editor_description = "If a character bumps into a wall while running, he will be stunned by \"wait_time\"(0.4s)."
process_callback = 0
one_shot = true

[node name="RunStoppingTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.3
one_shot = true

[node name="FloorStickBlockingTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.001
one_shot = true

[node name="WallSlidingGroundingBlockingTimer" type="Timer" parent="Timers"]
wait_time = 0.2
one_shot = true

[node name="TurningTimer" type="Timer" parent="Timers"]
process_callback = 0
wait_time = 0.07
one_shot = true

[node name="SlideDashTimer" type="Timer" parent="Timers"]
editor_description = "used
"
process_callback = 0
wait_time = 0.1
one_shot = true

[connection signal="area_entered" from="Rotatable/EntityComponentSystem" to="." method="_on_entity_component_system_area_entered"]
[connection signal="body_entered" from="Rotatable/GrindArea" to="." method="_on_grind_area_body_entered"]
[connection signal="body_exited" from="Rotatable/GrindArea" to="." method="_on_grind_area_body_exited"]
[connection signal="animation_changed" from="Anim" to="." method="_on_anim_animation_changed"]
[connection signal="current_animation_changed" from="Anim" to="." method="_on_anim_current_animation_changed"]
[connection signal="timeout" from="Timers/RunBufferTimer" to="." method="_on_run_stop_timer_timeout"]
[connection signal="timeout" from="Timers/FirstJumpStateTimer" to="." method="_on_first_jump_state_timer_timeout"]
[connection signal="timeout" from="Timers/BumpTimer" to="." method="_on_bump_timer_timeout"]
[connection signal="timeout" from="Timers/TurningTimer" to="." method="_on_turning_timer_timeout"]
[connection signal="timeout" from="Timers/SlideDashTimer" to="." method="_on_slide_dash_timer_timeout"]

[editable path="Rotatable/EntityComponentSystem"]
